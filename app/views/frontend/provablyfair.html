{% extends "frontend/partials/layout.njk" %}
{% block style %}

{% endblock %}
{% block body %}
<div class="col-lg-12 col-md-12">
  <div class="inner_content">
    <div class="bg-white inner-padding">
      <div class="p-rel">
        <h2 class="page-title">Provably Fair</h2>
      </div>
      <div class="row">
        <div class="col-lg-12">
          <div class="prov_tab">
           
            <ul class="nav nav-tabs">
              <li id="overviewTab" class="{% if(index==1) %}active{% endif %}"><a data-toggle="tab"
                  href="#overview">Overview</a></li>
              <li id="varifyfairTab" class="{% if(index==2) %}active{% endif %}"><a data-toggle="tab"
                  href="#verificationfairness">Verification of the Fairness</a></li>
              <li id="clientsheedTab" class="{% if(index==3) %}active{% endif %}"><a data-toggle="tab"
                  href="#changeSheedPair" class="changeSheed">Client Seed</a></li>
              <li id="emailVarificationTab" class="{% if(index==4) %}active{% endif %}"><a data-toggle="tab"
                  href="#emailVarification">Emails of Verification</a></li>
              {% if auth.user.id or auth.guest.id %}
              <li id="#select_fireworks" class="{% if(index==5) %}active{% endif %}"><a data-toggle="tab"
                  href="#select_fireworks">Select fireworks</a></li>
              {% endif %}
            </ul>

            <div class="tab-content">

              <div id="overview" class="tab-pane fade {% if(index==1) %}in active{% endif %}">
                <p>The roulette house cannot cheat. The stop number of the roulette is drawn using a server seed string
                  set before the start of the bets.</p>
                <p>So the house has no advantage because the state of the bets is unknown at that time. </p>
                <p>At the end of the game we check that the calculated number is the same than the one displayed by the
                  roulette.</p>
                <h4>Also, the stop number is the result of a calculation involving :</h4>
                <ul>
                  <li>As said, a server seed , randomly generated by the house</li>
                  <li>- + A client seed , chosen by the client</li>
                  <li>- + A nonce, depending on the time.</li>
                </ul>
                <p>The client seed can be changed at any time by the client . Of course you may ask , what happens if I
                  do not change it ? Well it's not a big deal , you just do not participate in the random generation of
                  the stop number , but , as already explained , the house has no advantage as long as the server seed
                  is set before the bets.</p>
                <p>The nonce also helps the client to "salt" the process.</p>
                <p>
                <h4>Implementation :</h4>
                </p>
                <p>- The stop number is calculated like this :</p>
                <p>The sha256(serverseed) is public and set in the client database before the bets .</p>
                <p>Just after the spin wheel, we calculate the Sha256(serverseed+clientseed+nonce),then we convert it
                  into decimal numbers.</p>
                <p>It starts like : 6745932537... , then we group the numbers two by two :</p>
                <p>67 45 93 25 37 ... And we look at the first group of two is less then 37. Here it is 25 . So the
                  number of the roulette will be 25 . The server seed string is revealed and checked.</p>
              </div>


              <div id="verificationfairness" class="tab-pane fade {% if(index==2) %}in active{% endif %}">
                <div class="md-form mb-5">
                  <label for="roundnumber">Please enter the number of the round :</label>
                  <div class="round-find">
                    <input type="number" min="0" step="1" id="roundnumber" class="form-control roundnumber">
                    <button type="button" class="btn btn-primary findFair">Find</button>
                  </div>
                </div>
                <div class="md-form mb-5">
                  <label for="txtroundStartTime">Round Start Time</label>
                  <input type="text" readonly id="txtroundStartTime" class="form-control proinput txtroundStartTime">
                </div>
                <div class="md-form mb-5">
                  <label for="txtserverSheed">Game Hash: Sha256(Server Seed) </label>
                  <input type="text" readonly id="txtserverSheed" class="form-control proinput txtserverSheed">
                </div>
                <div class="md-form mb-5">
                  <label for="txtnormalServerSeed">Server Seed</label>
                  <input type="text" readonly id="txtnormalServerSeed"
                    class="form-control proinput txtnormalServerSeed">
                </div>
                <div class="md-form mb-5">
                  <label for="txtclientSheed">Client Seed</label>
                  <input type="text" readonly id="txtclientSheed" class="form-control proinput txtclientSheed">
                </div>
                <div class="md-form mb-5">
                  <label for="txtnounce">Nonce</label>
                  <input type="text" readonly id="txtnounce" class="form-control proinput txtnounce">
                </div>
                <div class="md-form mb-5">
                  <label for="txtgameHash">Hash Generated : SHA512(Server Seed + Client Seed + Nonce)</label>
                  <input type="text" readonly id="txtgameHash" class="form-control proinput txtgameHash">
                </div>
                <div class="md-form mb-5 decimal-generated">
                  <label for="txtnumericHash">Decimal of The Hash Generated</label>
                  <div id="txtnumericHash" class="form-control proinput txtnumericHash">
                    <!-- <input type="text" readonly id="txtnumericHash" class="form-control proinput txtnumericHash"> -->
                  </div>

                  <div class="md-form mb-5">
                    <label for="txtstopNoRoulette">Stop Number</label>
                    <input type="text" readonly id="txtstopNoRoulette" class="form-control proinput txtstopNoRoulette">
                  </div>

                  <!-- <div class="md-form mb-5">
                  <label for="txtrevealedServerSheed">Revealed Server Sheed </label>
                  <input type="text" readonly id="txtrevealedServerSheed" class="form-control txtrevealedServerSheed">
                </div> -->

                  <!-- <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header text-center">
                      <h4 class="modal-title">Verification Fairness</h4>
                    </div>
                    <div class="modal-body mx-3">
                      
                    </div>
                  </div>
                </div> -->
                </div>
              </div>


              <div id="changeSheedPair" class="tab-pane fade {% if(index==3) %}in active{% endif %}">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header text-center">
                      <h4 class="modal-title w-100 font-weight-bold">Fairness</h4>
                    </div>
                    <div class="modal-body mx-3">
                      <!-- <div class="md-form mb-4">
                      <label for="serverseed">Server Seed</label>
                      <input type="text" readonly id="serverseed" class="form-control serverseed">                      
                    </div> -->
                      <div class="md-form mb-5">
                        <label for="clintseed">Client Seed</label>
                        <input type="text" id="clintseed" class="form-control clintseed">
                        <span class="noteclientseed">You do not have to memorize it . It's not a code nor a
                          password.</span>
                        <button class="Button-sc-relats-0 jVozgq changeClintseed"><span
                            class="styles__Wrap-gfba6z-0 jqggeP"><span>Change</span></button>
                        <div class="clearfix"></div>
                      </div>

                    </div>
                  </div>
                </div>
              </div>


              <div id="emailVarification" class="tab-pane fade {% if(index==4) %}in active{% endif %}">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-body mx-3">
                      <div class="md-form mb-5">
                        <!-- <label for="clintseed">Client Seed</label> -->
                        {% if auth.user.id %}
                        <label class="checkbox-inline"><input type="checkbox" class="isSelectEmailSend" {%
                            if(auth.user.isSelectEmailSend=="1" )%} checked {% else %}{% endif %}>I want to
                          receive <b> 2 live
                            emails
                            for each of my rounds. They will help me to understand the Bitroul Provably Fair. </b> They
                          will
                          memorize the server seed with it's timing of emission, proof that the game is Fair.</label>
                        {% else %}
                        <label class="checkbox-inline blockdiv"><input type="checkbox" class="isSelectEmailSend"
                            disabled>I want
                          to
                          receive <b> 2 live
                            emails
                            for each of my rounds. They will help me to understand the Bitroul Provably Fair. </b> They
                          will
                          memorize the server seed with it's timing of emission, proof that the game is Fair.</label>
                        <label for="" class="verifyEmaillbl">
                          Please sign up to qualify for this feature.
                        </label>
                        {% endif %}
                        <div class="clearfix"></div>
                      </div>

                    </div>
                  </div>
                </div>
              </div>

              <!-- <div id="select_fireworks" class="tab-pane fade {% if(index==5) %}in active{% endif %}">
                {% if auth.user.id %}
                <form action="/provably-fair/firework" method="post">
                  {% else %}
                    <form action="/provably-fair/fireworkGuest" method="post">
                  {% endif %}

                  {% if firworks %}
                    <div class="fireworks_main">
                      {% for fire in firworks %}
                        <input type="radio" name="fire" {% if  fire.firework_image == user.firework %} checked {% endif %}  id="" value="{{fire.firework_image}}">
                        <label for="fire">{{fire.firework_name}}</label>
                      {% endfor %}
                    </div>
                    <br>
                    <button class="">submit</button>
                  {% endif %}

                </form>
              </div> -->



              <div id="select_fireworks" class="tab-pane fade {% if(index==5) %}in active{% endif %}">
                {% if auth.user.id %}
                <form action="/provably-fair/firework" method="post">
                  {% else %}
                    <form action="/provably-fair/fireworkGuest" method="post">
                  {% endif %}

                  {% if firworks %}
                    <div class="fireworks_main">
                        {% for fire in firworks %}
                          {% if auth.user.id %}
                            <input type="radio" name="fire" {% if fire.firework_image == user.firework %} checked {% endif %}  id="" value="{{fire.firework_image}}">
                            <label for="fire">{{fire.firework_name}}</label>
                          {% elif auth.guest.id %}
                            <input type="radio" name="fire" {% if fire.firework_image == auth.guest.firework.fire %} checked {% endif %}  id="" value="{{fire.firework_image}}">
                            <label for="fire">{{fire.firework_name}}</label>
                          {% endif %}
                        {% endfor %}
                    </div>
                    <br>
                    <button class="">submit</button>
                  {% endif %}

                </form>
              </div>


            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
  {% endblock %}
  
  {% block script %}
  {% if auth.guest.id %}
  <script type="text/javascript" src="{{config.baseUrl}}frontend/script/guestprovably.js"></script>
  {% else %}
  <script type="text/javascript" src="{{config.baseUrl}}frontend/script/cryptoCurrency.js"></script>
  <script type="text/javascript" src="{{config.baseUrl}}frontend/script/provably.js"></script>

  <script>

    $(document).ready(function () {
      $('#txtnumericHash').slimscroll({
        height: '40px',
        width: '100%',
        axis: 'x',
        railVisible: true,
        alwaysVisible: true
      });
    });
  </script>

  {% endif %}
  {% endblock %}